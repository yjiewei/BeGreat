## 59.case when 获取有奖金的员工相关信息

```
获取有奖金的员工相关信息。
CREATE TABLE `employees` (
`emp_no` int(11) NOT NULL,
`birth_date` date NOT NULL,
`first_name` varchar(14) NOT NULL,
`last_name` varchar(16) NOT NULL,
`gender` char(1) NOT NULL,
`hire_date` date NOT NULL,
PRIMARY KEY (`emp_no`));
CREATE TABLE `dept_emp` (
`emp_no` int(11) NOT NULL,
`dept_no` char(4) NOT NULL,
`from_date` date NOT NULL,
`to_date` date NOT NULL,
PRIMARY KEY (`emp_no`,`dept_no`));
create table emp_bonus(
emp_no int not null,
received datetime not null,
btype smallint not null);
CREATE TABLE `salaries` (
`emp_no` int(11) NOT NULL,
`salary` int(11) NOT NULL,
`from_date` date NOT NULL,
`to_date` date NOT NULL, PRIMARY KEY (`emp_no`,`from_date`));
给出emp_no、first_name、last_name、奖金类型btype、对应的当前薪水情况salary以及奖金金额bonus。 bonus类型btype为1其奖金为薪水salary的10%，btype为2其奖金为薪水的20%，其他类型均为薪水的30%。 当前薪水表示to_date='9999-01-01'
输出格式:
```

![image-20201226164840801](SQL题解模板.assets/image-20201226164840801.png)



## 题解

```
这题没怎么看，重心放在了case when上面。
case xx
	when x then xxx
	when y then yyy
	else xxx
end
```



## 代码

```sql
-- 四张表
-- emp_no	first_name	last_name	btype	salary	bonus
select e.emp_no,e.first_name,e.last_name,b.btype,s.salary,
(case b.btype 
    when 1 then s.salary * 0.1
     when 2 then s.salary * 0.2
     else  s.salary * 0.3 end) as bonus
from employees e inner join emp_bonus b on e.emp_no = b.emp_no
inner join salaries as s on e.emp_no = s.emp_no
where b.btype is not null and s.to_date = '9999-01-01';
```

